"use strict";
Object.defineProperty(exports, "__esModule", {
    value: true
});
exports.remoteDevtoolsCorsMiddleware = remoteDevtoolsCorsMiddleware;
var _url = require("url");
function remoteDevtoolsCorsMiddleware(req, res, next) {
    if (req.url) {
        var ref;
        const url = (0, _url).parse(req.url);
        const origin = req.headers.origin;
        const isValidOrigin = origin && [
            "devtools://devtools",
            "https://chrome-devtools-frontend.appspot.com"
        ].includes(origin);
        if (((ref = url.pathname) == null ? void 0 : ref.endsWith(".map")) && origin && isValidOrigin) {
            res.setHeader("Access-Control-Allow-Origin", origin);
            // Prevent metro overwrite Access-Control-Allow-Origin header
            const setHeader = res.setHeader.bind(res);
            res.setHeader = (key, ...args)=>{
                if (key !== "Access-Control-Allow-Origin") {
                    setHeader(key, ...args);
                }
                return res;
            };
        }
    }
    next();
}

//# sourceMappingURL=remoteDevtoolsCorsMiddleware.js.map